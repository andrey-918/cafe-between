# Инструкции по обновлению для сохранения фотографий

## Проблема
При перезапуске Docker контейнеров все загруженные фотографии удалялись, так как они хранились внутри контейнера.

## Решение
Добавлен Docker volume для постоянного хранения фотографий на хосте.

## Что было изменено:

1. **docker-compose.yml**
   - Добавлен volume `uploads_data` для backend сервиса
   - Volume монтируется в `/root/uploads` внутри контейнера

2. **backend/internal/handlers/utils.go**
   - Обновлены пути с относительных `uploads/` на абсолютные `/root/uploads/`
   - Теперь все файлы сохраняются в правильную директорию

3. **backend/Dockerfile**
   - Удалено копирование папки uploads при сборке
   - Добавлено создание директории `/root/uploads` (будет использоваться volume)

## Как применить изменения:

### Шаг 1: Остановить контейнеры
```bash
docker-compose down
```

### Шаг 2: Пересобрать backend контейнер
```bash
docker-compose build backend
```

### Шаг 3: Запустить контейнеры
```bash
docker-compose up -d
```

### Шаг 4: Проверить, что volume создан
```bash
docker volume ls | grep uploads_data
```

## Результат:
- Все новые загруженные фотографии будут сохраняться в Docker volume `uploads_data`
- При перезапуске контейнеров фотографии НЕ будут удаляться
- Фотографии хранятся на хосте в `/var/lib/docker/volumes/cafe-between_uploads_data/_data/`

## Важно:
⚠️ Существующие фотографии в контейнере будут потеряны при первом перезапуске после этих изменений. После этого все новые фотографии будут сохраняться постоянно.

## Резервное копирование (опционально):
Если нужно сохранить текущие фотографии перед обновлением:

```bash
# Скопировать фотографии из контейнера на хост
docker cp cafe-between-backend:/root/uploads ./backup_uploads

# После обновления скопировать обратно в volume
docker cp ./backup_uploads/. cafe-between-backend:/root/uploads/
